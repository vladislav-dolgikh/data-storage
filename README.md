# data-storage

## Стандарт хранения обработанных данных ChIP-seq

![image](https://user-images.githubusercontent.com/83860672/213987399-89df50aa-c6f5-4430-a5a3-1b122a3fc0a6.png)

Стандартный конвейер для обработки сырых данных ***ChIP-seq*** включает в себя этапы **(1)** контроля качества сырых данных, **(2)** предобработки сырых данных, **(3)** выравнивания сырых данных на референсный геном и **(4)** определения пиков. Каждый этап конвейера обозначается определенной латинской буквой-переменной, которая, в зависимости от режимов запуска программ, может принимать соответствующее значение. Данный подход основан на рекомендациях консорциума [ENCODE](https://www.encodeproject.org/chip-seq/transcription_factor/).

### Контроль качества сырых данных

Этап контроля качества сырых данных позволяет оценить качество секвенирования образца и позволяет исследователю принять решение о целесообразности предобработки данных. Контроль качества осуществляется при помощи инструмента **FastQC**. Данный этап в конвейере обозначается как `qc` (***q***uality ***c***ontrol), чьё значение всегда равно единице, так как контроль качества является обязательным этапом, проводящимся единообразно для любого эксперимента.

### Предобработка сырых данных

Предобработка сырых данных позволяет **(1)** удалять из прочтений нуклеотиды низкого качества, **(2)** удалять адаптерные последовательности, **(3)** удалять прочтения, не соответствующие заданным параметрам. Эти операции позволяют улучшить качество образцов. Данная процедура может осуществляться при помощи пакетов **Trimmomatic** и **fastp** Предобработка данных не является обязательным этапом, и решение о её проведении исследователь принимает в результате контроля качества. Данный этап обозначается буквой `p` (***p***reprocessing). `p` может принимать значения `0` (предобработка не производилась), `1` (предобработка производилась при помощи **Trimmomatic**) и `2` (предобработка производилась при помощи **fastp**).

### Выравнивание сырых данных на референсный геном

Этап выравнивания сырых данных выполняется при помощи программных пакетов **Bowtie** (при длине прочтений менее 50 п.н.), **Bowtie2** (при длине прочтений 50 п.н. и более) или других пакетов, выполняющих аналогичную функцию. Обозначается буквой `a` (***a***lignment). `a` может принимать значения `1` (использовался пакет **Bowtie**), `2` (использовался пакет **Bowtie2**) и `3` (использовался другой пакет).

### Определение пиков ChIP-seq

Этап определения пиков ***ChIP-seq*** необходим для локализации районов связывания ТФ в геноме. Определение пиков может осуществляться при помощи инструмента **MACS3** или других аналогичных программ. Существует несколько подходов к определению пиков, схематично изображенном на схеме:


Этап определения пиков обозначается буквой `c` (peak ***c***alling). `c` может принимать значения `1` (использовался режим ***simple callpeak***, включающий получение пиков при помощи запуска `MACS3 callpeak`), `2` (использовался режим ***callpeak with IDR***, включающий связку `MACS3 callpeak` + `IDR`) и `3` (использовался режим ***callpeak with bdgdiff***, включающий связку `MACS3 callpeak` + `MACS3 bdgdiff`)


### Формат хранения данных

Пики ***ChIP-seq*** должны храниться в формате `BED` или `WIG`. Допустим формат `BED3`, а также опционально допустимы его расширения.

### Стандарты аннотации данных ChIP-seq в хранилище auxin

Обработанные данные ***ChIP-seq*** хранятся в хранилище данных. Метаданные в хранилище представлены для сырых и обработанных в виде соответствующих таблиц.

|Название столбца|Содержание столбца|
|----------------|:----------------:|
|Transcription factor name|Название изучаемого ТФ|
|Library|Тип библиотеки. Принимает значения `single` или `paired`|
|Platform|Платформа, на которой проводилось секвенирование|
|Ecotype|Экотип образца. Стандартно `Col0`, если мутант - указывается название мутации|
|Treatment|Тип обработки образца|
|Duration|Время обработки образца|
|Tissue|Ткань растения|
|Growth conditions|Условия прорастания|
|Treatment raw samples|Идентификационные номера сырых образцов, использованных в качестве `treatment` в данном эксперименте. Имеет вид `SRXXXXXXXX1, SRXXXXXXXX2, SRXXXXXXXX3 ... SRXXXXXXXXn`|
|Control raw samples|Идентификационные номера сырых образцов, использованных в качестве `control` в данном эксперименте. Имеет вид `SRXXXXXXXX1, SRXXXXXXXX2, SRXXXXXXXX3 ... SRXXXXXXXXn`|
|Input control raw samples|Идентификационные номера сырых образцов, использованных в качестве `input control` в данном эксперименте. Имеет вид `SRXXXXXXXX1, SRXXXXXXXX2, SRXXXXXXXX3 ... SRXXXXXXXXn`. При отсутствии внешнего контроля принимает значение `0`|
|Data processing conditions|Описание условий обработки данных в виде кортежа `qc, p, a, c`. Значения, которые может принимать каждая переменная, описаны в разделе **Конвейер для обработки сырых данных ChIP-seq**. Например, `1,1,2,3`|
|Peak number|Количество пиков в эксперименте|
|Average peak length|Средняя длина пика|
|Reference|`PMID` статьи, в которой был описан эксперимент|
|Data directory name|Название директории, депонированного в хранилище. Имеет вид `Название изучаемого ТФ` + `Время обработки образца` + `Тип режима определения пиков` + `Первый автор статьи, в которой опубликован эксперимент`. Например, `ARR1_4h_bdgdiff_Xie`|

Каждый эксперимент хранится в директории по адресу `public/datasets/chip-seq-datasets/data-directory-name`. ***data-directory-name*** совпадает с соответствующим значением в метаданных. Директория, в которой хранятся данные эксперимента, содержит:

- `bed`/`wig` файл с пиками (название файла должно совпадать с названием директории)
- графики смещения тэгов от **MACS3** и воспроизводимости пиков в репликах от **IDR** при наличии
- скрипт, которым проводилась обработка (название файла должно иметь вид `data-directory-name` + `_processing`)

Скрипт должен содержать шапку (в виде комментария), в которой содержится информация о: 
- типе эксперимента;
- количестве образцов;
- ФИО проводившего обработку;
- дате проведения обработки.

В комментариях к строкам команд запуска программ указывается версия программы.

## Стандарт хранения обработанных данных RNA-seq

![image](https://user-images.githubusercontent.com/83860672/214209486-47547381-af17-4843-8ae8-fdc6c7cecf27.png)

Стандартный конвейер для обработки сырых данных ***RNA-seq*** включает в себя этапы **(1)** контроля качества сырых данных, **(2)** предобработки сырых данных, **(3)** выравнивания сырых данных на референсный геном, **(4)** квантификации прочтений и **(5)** поиска дифференциально экспрессирующихся генов (ДЭГ). Каждый этап конвейера обозначается определенной латинской буквой-переменной, которая, в зависимости от режимов запуска программ, может принимать соответствующее значение. Данный подход основан на рекомендациях консорциума [ENCODE](https://www.encodeproject.org/pipelines/ENCPL002LPE/).

### Контроль качества сырых данных

Этап контроля качества сырых данных позволяет оценить качество секвенирования образца и позволяет исследователю принять решение о целесообразности предобработки данных. Контроль качества осуществляется при помощи инструмента **FastQC**. Данный этап в конвейере обозначается как `qc` (***q***uality ***c***ontrol), чьё значение всегда равно единице, так как контроль качества является обязательным этапом, проводящимся единообразно для любого эксперимента.

### Предобработка сырых данных

Предобработка сырых данных позволяет **(1)** удалять из прочтений нуклеотиды низкого качества, **(2)** удалять адаптерные последовательности, **(3)** удалять прочтения, не соответствующие заданным параметрам. Эти операции позволяют улучшить качество образцов. Данная процедура может осуществляться при помощи пакетов **Trimmomatic** и **fastp** Предобработка данных не является обязательным этапом, и решение о её проведении исследователь принимает в результате контроля качества. Данный этап обозначается буквой `p` (***p***reprocessing). `p` может принимать значения `0` (предобработка не производилась), `1` (предобработка производилась при помощи **Trimmomatic**) и `2` (предобработка производилась при помощи **fastp**).

### Выравнивание сырых данных на референсный геном

Этап выравнивания сырых данных выполняется при помощи программных пакетов **hisat2**, **STAR** или других аналогичных. Обозначается буквой `a` (***a***lignment). `a` может принимать значения `1` (использовался пакет **hisat2**), `2` (использовался пакет **STAR**) или `3` (использовался другой инструмент).

### Квантификация выровненных прочтений

Этап квантификации вырованенных прочтений выполняется либо при помощи программы **htseq-count**, либо внутри R-пакетов **DESeq2** или **EdgeR**. Обозначается буквой `q` (***q***uantification). `q` может принимать значения `1` (использовался R-пакет **DESeq2**), `2` (использовался инструмент **htseq-count**) и `3` (использовался R-пакет **EdgeR**).

### Поиск дифференциально экспрессирующихся генов

Поиск ДЭГов выполняется внутри R-пакетов **DESeq2** или **EdgeR**. Обозначается буквой `d` (***d***ifferential expression analysis). `d` может принимать значения `1` (использовался R-пакет **DESeq2**) и `2` (использовался R-пакет **EdgeR**).

### Стандарты аннотации данных RNA-seq в хранилище auxin

Обработанные данные ***RNA-seq*** хранятся в хранилище данных. Сырые данные не хранятся, но присутствуют скрипты, использовавшиеся при их обработке. Метаданные в хранилище представлены для сырых и обработанных в виде соответствующих таблиц.

|Название столбца|Содержание столбца|
|----------------|:----------------:|
|Phytohormone name|Название гормона, индуцирующего транскрипционный ответ|
|Library|Тип библиотеки. Принимает значения `single` или `paired`|
|Platform|Платформа, на которой проводилось секвенирование|
|Ecotype|Экотип образца. Стандартно `Col0`, если мутант - указывается название мутации|
|Duration|Время обработки образца|
|Tissue|Ткань растения|
|Growth conditions|Условия прорастания|
|Treatment raw samples|Идентификационные номера сырых образцов, использованных в качестве `treatment` в данном эксперименте. Имеет вид `SRXXXXXXXX1, SRXXXXXXXX2, SRXXXXXXXX3 ... SRXXXXXXXXn`|
|Control raw samples|Идентификационные номера сырых образцов, использованных в качестве `control` в данном эксперименте. Имеет вид `SRXXXXXXXX1, SRXXXXXXXX2, SRXXXXXXXX3 ... SRXXXXXXXXn`|
|Data processing conditions|Описание условий обработки данных в виде кортежа `qc, p, a, q, d`. Значения, которые может принимать каждая переменная, описаны в разделе **Конвейер для обработки сырых данных RNA-seq**. Например, `1,1,1,3,2`|
|Up-regulated DEG number|Количество ДЭГ, повышающих уровень экспрессии в ответ на обработку|
|Down-regulated DEG number|Количество ДЭГ, понижающих уровень экспрессии в ответ на обработку|
|Reference|`PMID` статьи, в которой был описан эксперимент|
|Data directory name|Название директории, в которой хранятся файлы, депонированные в хранилище. Имеет вид `Название фитогормона` + `Время обработки образца` + `Первый автор статьи, в которой опубликован эксперимент`. Например, `Ethylene_4h_Chang.txt`|

Каждый эксперимент хранится в директории по адресу `public/datasets/rna-seq-datasets/data-directory-name`. ***data-directory-name*** совпадает с соответствующим значением в метаданных. Директория, в которой хранятся данные эксперимента, содержит:

- таблица сырых каунтов
- таблица, содержащая информацию о дифференциально экспрессирующихся генах (название файла должно совпадать с названием директории)
- скрипт, которым проводилась обработка (название файла должно иметь вид `data-directory-name` + `_processing`)

Скрипт должен содержать шапку (в виде комментария), в которой содержится информация о: 
- типе эксперимента;
- количестве образцов;
- ФИО проводившего обработку;
- дате проведения обработки.

В комментариях к строкам команд запуска программ указывается версия программы.

## Стандарт хранения обработанных данных микрочиповых экспериментов

Сырые данные микрочиповых экспериментов обычно депонированы в [GEO](https://www.ncbi.nlm.nih.gov/geo/) в виде файлов в формате ***CEL***. Обработка данных микрочиповых экспериментов включает в себя поиск значений уровней экспрессии для каждого гена в исследуемом и контрольном образцах (аналог сырых каунтов для данных RNA-seq) и поиск дифференциально экспрессирующихся генов. В стандартном конвейере обработки данных микрочиповых экспериментов эти операции выполняются при помощи R-пакетов  **Affy** и  **limma**.

### Стандарты аннотации данных RNA-seq в хранилище auxin

Обработанные данные ***RNA-seq*** хранятся в хранилище данных. Сырые данные не хранятся, но присутствуют скрипты, использовавшиеся при их обработке. Метаданные в хранилище представлены для сырых и обработанных в виде соответствующих таблиц.

|Название столбца|Содержание столбца|
|----------------|:----------------:|
|Phytohormone name|Название гормона, индуцирующего транскрипционный ответ|
|Platform|Платформа, на которой проводился эксперимент|
|Ecotype|Экотип образца. Стандартно `Col0`, если мутант - указывается название мутации|
|Duration|Время обработки образца|
|Tissue|Ткань растения|
|Growth conditions|Условия прорастания|
|Treatment raw samples|Идентификационные номера сырых образцов, использованных в качестве `treatment` в данном эксперименте. Имеет вид `GSMXXXXXXX1, GSMXXXXXXX2, GSMXXXXXXX3 ... GSMXXXXXXXn`|
|Control raw samples|Идентификационные номера сырых образцов, использованных в качестве `control` в данном эксперименте. Имеет вид `GSMXXXXXXX1, GSMXXXXXXX2, GSMXXXXXXX3 ... GSMXXXXXXXn`|
|Up-regulated DEG number|Количество ДЭГ, повышающих уровень экспрессии в ответ на обработку|
|Down-regulated DEG number|Количество ДЭГ, понижающих уровень экспрессии в ответ на обработку|
|Reference|`PMID` статьи, в которой был описан эксперимент|
|Data directory name|Название директории, в которой хранятся файлы, депонированные в хранилище. Имеет вид `Название фитогормона` + `Время обработки образца` + `Первый автор статьи, в которой опубликован эксперимент`. Например, `Ethylene_4h_Chang.txt`|

Каждый эксперимент хранится в директории по адресу `public/datasets/microarrays-datasets/data-directory-name`. ***data-directory-name*** совпадает с соответствующим значением в метаданных. Директория, в которой хранятся данные эксперимента, содержит:

- таблица значений уровней экспрессии
- таблица, содержащая информацию о дифференциально экспрессирующихся генах (название файла должно совпадать с названием директории)
- скрипт, которым проводилась обработка (название файла должно иметь вид `data-directory-name` + `_processing`)

Скрипт должен содержать шапку (в виде комментария), в которой содержится информация о: 
- типе эксперимента;
- количестве образцов;
- ФИО проводившего обработку;
- дате проведения обработки.

В комментариях к строкам команд запуска программ указывается версия программы.
